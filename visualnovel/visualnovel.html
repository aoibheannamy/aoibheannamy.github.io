<!DOCTYPE HTML>
<html>

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Visual Novel Example </title>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.0.0/lib/p5.js"></script>
    <script src="../javascript/p5.js"></script>
    <link href="https://unpkg.com/tabulator-tables@4.6.3/dist/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.6.3/dist/js/tabulator.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.0.5/jspdf.plugin.autotable.js"></script>

    <script type="text/javascript" src="../KillTheBatmanFrame.json"></script>
    <script type="text/javascript" src="../KillTheBatmanAppearances.json"></script>
    <script type="text/javascript" src="../locations.json"></script>
    <script type="text/javascript" src="../characterJson/batmanCharacters.json"></script>
    <script type="text/javascript" src="../visualNovelJsons/backgroundLocations.json"></script>
    <script type="text/javascript" src="../javascript/getBackgrounds.js"></script>
    <script type="text/javascript" src="../javascript/getCharacterImage.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

    <style>
        #table {
            margin-top: 750px;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="d-flex flex-grow-1">
            <span class="w-100 d-lg-none d-block">
                <!-- hidden spacer to center brand on mobile --></span>
            <a class='navbar-brand' href='../../index.html'>Scene to Visual Novel</a>
            <div class="w-100 text-right">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#myNavbar7">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
        </div>
        <div class="collapse navbar-collapse flex-grow-1 text-right" id="myNavbar7">
            <ul class="navbar-nav ml-auto flex-nowrap">
                <li class='nav-item'>
                    <a class='nav-link' href='../../index.html'>Home <span class='sr-only'>(current)</span></a>
                </li>
                <li class='nav-item'>
                    <a class='nav-link' href='../../about.html'>About</a>
                </li>
                <li class='nav-item dropdown'>
                    <a class='nav-link dropdown-toggle' href='#' id='navbarDropdownMenuLink' role='button'
                        data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>
                        Personality Information
                    </a>
                    <div class='dropdown-menu' aria-labelledby='navbarDropdownMenuLink'>
                        <a class='dropdown-item' href='../personality/myersBriggsDoc.html'>Myers Briggs
                            Description</a>
                        <a class='dropdown-item ' href='../personality/heroVsVillain.html'>Heroes V. Villain
                            Personalities</a>
                        <a class='dropdown-item' href='../personality/goodvbadvambig.html'>Antagonist/protagonist
                            Database</a>
                        <a class='dropdown-item' href='../personality/matchesFromOtherUniverses.html'>Personality
                            Matches
                            from other Universes</a>
                        <a class='dropdown-item' href='../personality/gameOfThrones/gotHome.html'>Game of Thrones</a>
                    </div>
                </li>
                <li class='nav-item'>
                    <a class='nav-link active' href='visualnovel.html'>Visual Novel</a>
                </li>
            </ul>
        </div>
    </nav>


    <div class="row">
        <div id="sketch-holder">

        </div>
    </div>



    <script>
        let bg;
        let img;
        //let fontsize = 30;
        let textWords = "";
        let myFont;
        let charSpeaking = "";

        function setup() {
            // create the canvas
            var canvas = createCanvas(5 * windowWidth / 6, windowHeight);
            // position canvas
            canvas.position(50, 50);
            // display as block
            canvas.style('display', 'block');

            // set background as image
            bg = loadImage('../Images/placeholderImage.jpg');
            // any additional images loaded here
            img = loadImage('../Images/placeholderImage.jpg');
            // set container to hold the canvas
            canvas.parent('sketch-holder');
            textAlign(CENTER, CENTER);

        }

        /**
         * function to render the draw call of canvas elements
         */ 
        function draw() {
            clear();
            // set/insert background
            if (rowLocIndex >= 1) {
                setBackgroundImage();
                background(bg);
            }
            // insert image
            if (rowIndex >= 1) {
                // call in function to set and load the correct image
                setCharacterImage();
                
                image(img, 0, height / 2, img.width / 2, img.height / 2);
                // check what image has been loaded
                console.log("Image: "+img);
            }
            // call drawWords function
            drawWords(width * 0.5);

            // call in character json files
            //batmanChars = JSON.parse(batmanCharacters);


            // iterate the row index to automatically move to the next frame
            rowIndex++;


        }

        function drawWords() {
            if (rowIndex >= 1) {
                drawSpeechBubble();
                fill(0);
                stroke(0);
                strokeWeight(2);
                textSize(20);
                text(textWords, 330, 80, 200, 200);
                textSize(16);
                fill(0);
                stroke(0);
                strokeWeight(1);
                text(charSpeaking, 430, 130);
            }
        }

        function drawSpeechBubble() {
            fill(290);
            stroke(0);
            ellipse(430, 150, 250, 160);

        }

    </script>

    <div class="container" id="table">
        <h4>Location/Background of Scene</h4>
        <div id="example-table-loc"></div>
        <script type="text/javascript">
            //var loc_data = location_data;
            var rowLocIndex = 0;
            var locTable = new Tabulator("#example-table-loc", {
                index: "ID",
                selectable: 1,
                pagination: "local",
                paginationSize: 10,
                layout: "fitColumns",
                placeholder: "No Data Available",
                columns: [
                    {
                        title: "ID", field: "ID", editor: "input"
                    },
                    {
                        title: "Location", field: "Location", editor: "select", editorParams: {
                            values: {
                                "BoardRoom": "Board Room", "Forest": "Forest", "Beach": "Beach", "Office": "Office", "Warehouse": "Warehouse", "Club/Bar": "Club/Bar", "Supermarket": "Supermarket", "Bedroom": "Bedroom", "Street": "Street", "Prison": "Prison"
                            },
                        }

                    },

                ],
                rowClick: function (e, row) {
                    rowLocIndex = row.getIndex();
                    // displays index
                    console.log("Row index: " + rowLocIndex);
                    var rowLocData = row.getData();
                    // get location data
                    var backgroundLocation = row.getData().Location;
                    // displays location data for that index
                    console.log(backgroundLocation);

                }


            });

            locTable.addRow({ ID: 1 }, false);

        </script>
    </div>


    <div class='container'>
        <h4>Frame by Frame</h4>
        <div id="example-table2"></div>
        <!-- ---------------------------------------------------------------- -->
        <script type="text/javascript">
            var local_data = esp_data;  //name inside json file -->	
            var rowIndex = 0;
            var table = new Tabulator("#example-table2", {
                index: "FrameNumber",
                selectable: 1,
                data: local_data,
                pagination: "local",
                paginationSize: 10,
                layout: "fitColumns",
                placeholder: "No Data Available",
                columns: [
                    {
                        title: "Frame", field: "FrameNumber", editor: "input", cellClick: function (e, cell) {
                            var cellValue = cell.getValue();
                            // console.log(cellValue);
                            var data = cell.getData();
                            //console.log("Data: "+data.toString());
                        }
                    },
                    { title: "Character", field: "CharacterNumber", editor: "input" },
                    { title: "Niceness", field: "Agreeableness/Niceness", editor: "input" },
                    { title: "Confidence", field: "Confidence", editor: "input" },
                    { title: "Facial Expression", field: "FacialExpression", editor: "input" },
                    { title: "Eyes/Brows", field: "Eyes/Brows", editor: "input" },
                    { title: "Nose", field: "Nose", editor: "input" },
                    { title: "Mouth", field: "Mouth", editor: "input" },
                    { title: "Skin", field: "Skin", editor: "input" },
                    { title: "Whole-Face Expression", field: "WholeFace", editor: "input" },
                    { title: "Head Movement", field: "HeadMovement", editor: "input" },
                    { title: "Emotion", field: "Emotion", editor: "input" },
                    { title: "Is a Character Speaking?", field: "CharacterSpeaking", editor: "input" },
                    { title: "What are they saying?", field: "WhatDoTheySay", editor: "input" },
                    { title: "Inflection?", field: "Inflection", editor: "input" },
                    { title: "Action", field: "Action", editor: "input" },
                    { title: "Sound Effects", field: "SoundEffects", editor: "input" },
                    { title: "Props", field: "Props", editor: "input" },
                ],
                rowClick: function (e, row) {
                    rowIndex = row.getIndex();
                    // displays index
                    console.log("Row index: " + rowIndex);
                    var rowData = row.getData();
                    // displays row data for that index
                    console.log(rowData);

                    // get the character number in that row to figure out which character is in the scene
                    var charNo = row.getData().CharacterNumber;
                    // get the emotion of the character in that scene
                    var charEmotion = row.getData().Emotion;




                    // is the character speaking and who is it?
                    var charSpeak = row.getData().CharacterSpeaking;
                    // what do they say?
                    var spokenWords = row.getData().WhatDoTheySay;
                    // set text variable to words in table
                    textWords = spokenWords;
                    // call drawWords() to print to screen
                    if (charSpeak == 1) {
                        charSpeaking = "Character " + charSpeak + " is speaking:";
                    } else if (charSpeak == 2) {
                        charSpeaking = "Character " + charSpeak + " is speaking:";
                    } else if (charSpeak = 3) {
                        charSpeaking = "Character " + charSpeak + " is speaking:";
                    } else if (charSpeak = 4) {
                        charSpeaking = "Character " + charSpeak + " is speaking:";
                    } else {
                        charSpeaking = "No Character is speaking.";
                    }
                    rowIndex++;







                }
            });


        </script>
        <!-- -------------------------------------------------------------------- -->
    </div>
    </div>
    </div>
</body>

</html>